## --- New Market Entry Strategist ---
## This app guides a startup through the process of entering a new market.
## It gathers company data, analyzes the target market, suggests entry
## strategies, and compiles a final summary report.

#Show: "## Welcome to the New Market Entry Strategist!"

## --- Step 0: Mode Selection ---
## Ask the user if they want a quick (Standard) or full (Advanced) analysis.
## We use a loop to ensure valid input is received.
#Text: mode_q
"n"
#Loop-Until: [mode_q]="y"
   #Question: advanced_mode
   "This app can run in two modes:
   1. **Standard** - A quick, high-level overview.
   2. **Advanced** - A detailed, deep-dive analysis.
   
   Please choose an option ('2' = Advanced, '1' = Standard):"
   #If [advanced_mode]="1" #Begin
      #Text: mode_q
      "y"
      #Text: advanced_mode
      "n"
   #End
   #If [advanced_mode]="2" #Begin
      #Text: mode_q
      "y"
      #Text: advanced_mode
      "y"
   #End
#End

## --- Step 1: Company Profile ---
#Show: "### Step 1: Company Profile
Please provide some background on your company."

#Question: company_name
"What is your company name?"

#Question: company_hq
"Where is your headquarters located?"

#Question: company_employees
"How many employees do you have?
(e.g., '1-10', '11-50', '51-200', '200+')"

#Question: company_products
"What are your main products or services?"

#Question: company_summary
"What is your company website or a short business summary?"

## --- Step 2: Target Market ---
#Show: "### Step 2: Target Market
Now, let's define your expansion goals."

#Question: target_country
"What country or region do you plan to enter?
('s' = Saudi Arabia)"
#If [target_country]="s" #Begin
   #Text: target_country
   "Saudi Arabia"
#End

#Question: target_customer
"What type of customers are you targeting?
('g' = government, 'e' = enterprise, 's' = SME, 'c' = consumer)"
#If [target_customer]="g" #Begin
   #Text: target_customer
   "government"
#End
#If [target_customer]="e" #Begin
   #Text: target_customer
   "enterprise"
#End
#If [target_customer]="s" #Begin
   #Text: target_customer
   "SME"
#End
#If [target_customer]="c" #Begin
   #Text: target_customer
   "consumer"
#End

#Question: target_product
"What specific product or service do you plan to introduce there?"

#Question: target_goal
"What is your primary goal?
('s' = sales growth, 'p' = partnership, 'i' = investment, 'l' = local setup)"
#If [target_goal]="s" #Begin
   #Text: target_goal
   "sales growth"
#End
#If [target_goal]="p" #Begin
   #Text: target_goal
   "partnership"
#End
#If [target_goal]="i" #Begin
   #Text: target_goal
   "investment"
#End
#If [target_goal]="l" #Begin
   #Text: target_goal
   "local setup"
#End

## --- Consolidate Profile ---
## Store all inputs in a single variable for easy reference in AI prompts.
#Text: company_profile
"## User's Company Profile:
- **Company Name:** [company_name]
- **Headquarters:** [company_hq]
- **Employees:** [company_employees]
- **Products/Services:** [company_products]
- **Summary:** [company_summary]

## User's Target Market:
- **Target Country:** [target_country]
- **Target Customer:** [target_customer]
- **Product to Introduce:** [target_product]
- **Primary Goal:** [target_goal]"

## --- Check Mode ---
## If Standard mode, we skip the deep analysis and go to the final report.
#If [advanced_mode]="n" #Begin
   ## Set placeholder variables for the Standard report
   #Text: market_overview
   "N/A (Standard Mode)"
   #Text: entry_modes
   "N/A (Standard Mode)"
   #Text: risk_analysis
   "N/A (Standard Mode)"
   #Text: deepdive_analysis
   "N/A (Standard Mode)"
#Else-Begin
   ## --- Advanced Mode ---

   ## --- Step 3: Market Overview ---
   #Show: "Working... researching market overview for [target_country]..."
   
   #Text: search_query_market
   "Industry overview for [target_product] in [target_country]"
   #chatgptsearch: market_search_results
   "[search_query_market]\n\nAnd: Regulatory framework for [target_product] in [target_country] (licensing, local presence, data laws, local hiring quotas)"
   
   #claude: market_overview_ai
   "Based on the following user profile and live search results, generate the 'Market Overview' section for their report.

   User Profile:
   [company_profile]
   
   Search Results:
   [market_search_results]
   
   Generate the following sections in clear, professional markdown:
   1.  **Industry Overview:** A brief on the [target_product] sector in [target_country].
   2.  **Regulatory Framework:** Key info on licensing, local presence, data laws, and local hiring quotas (like Saudization if applicable).
   3.  **Major Competitors & Potential Partners:** List 2-3 of each.
   4.  **Key Entry Barriers & Market Trends:**"
   
   #Text: market_overview
   "[market_overview_ai]"
   #Show: "### Step 3: Market Overview
   [market_overview]"

   ## --- Step 4: Entry Mode Options ---
   #Show: "Working... analyzing potential entry modes..."
   
   #claude: entry_modes_ai
   "Based on the user's profile and the market overview below, recommend 3-4 viable 'Entry Mode Options'. For each, provide a brief pro/con.
   
   User Profile:
   [company_profile]
   
   Market Overview:
   [market_overview]
   
   Recommend from these options:
   - Direct export / remote delivery
   - Partnership with local distributor or JV
   - Local subsidiary setup (LLC or branch)
   - Collaboration through accelerators or government programs"
   
   #Text: entry_modes
   "[entry_modes_ai]"
   #Show: "### Step 4: Recommended Entry Modes
   [entry_modes]"

   ## --- Step 5: Risk & Problem Analysis ---
   #Show: "Working... researching key risks and challenges..."
   
   #Text: search_query_risks
   "Key challenges for a [company_employees]-employee company in the [company_products] sector entering [target_country]"

   ##debug   
   ##Show: "yyy [search_query_risks]"
   
   #chatgptsearch: risk_search_results
   "[search_query_risks]"
   
   #claude: risk_analysis_ai
   "Based on the user's profile and these live search results, list the 3-5 most critical 'Key Challenges' this company will face.   

   User Profile:
   [company_profile]

   Search Results:
   [risk_search_results]

   Focus on risks relevant to their size, sector, and market (e.g., compliance, cultural alignment, brand awareness, cost of operations)."
   
   #Text: risk_analysis
   "[risk_analysis_ai]"
   #Show: "### Step 5: Key Risks & Challenges
   [risk_analysis]"

   ## --- Step 6: Focus Area Selection ---
   #Show: "### Step 6: Focus Area Selection"
   
   #Text: focus_valid
   "n"
   #Loop-Until: [focus_valid]="y"
      #Question: focus_choice
      "Which area would you like to focus on first for a deep-dive analysis?
      
      1. Partnerships & Local Representation
      2. Sales & Distribution Setup
      3. Legal & Compliance Framework
      4. Talent & Local Hiring (e.g., Saudization)
      5. Branding & Visibility
      
      Please choose a number (e.g., '3'):"
      
      #If [focus_choice]="1" #Begin
         #Text: focus_area
         "Partnerships & Local Representation"
         #Text: focus_valid
         "y"
      #End
      #If [focus_choice]="2" #Begin
         #Text: focus_area
         "Sales & Distribution Setup"
         #Text: focus_valid
         "y"
      #End
      #If [focus_choice]="3" #Begin
         #Text: focus_area
         "Legal & Compliance Framework"
         #Text: focus_valid
         "y"
      #End
      #If [focus_choice]="4" #Begin
         #Text: focus_area
         "Talent & Local Hiring"
         #Text: focus_valid
         "y"
      #End
      #If [focus_choice]="5" #Begin
         #Text: focus_area
         "Branding & Visibility"
         #Text: focus_valid
         "y"
      #End
   #End

   ## --- Step 7: Deep-Dive Analysis ---
   #Show: "Working... conducting deep-dive analysis on '[focus_area]'..."
   
   #Text: search_query_deepdive
   "Actionable plan for [focus_area] for a foreign company entering [target_country].
   And: Key partners and enablers in [target_country] for [focus_area] (e.g., MISA, Monsha'at, KAUST, RSG)"
   #chatgptsearch: deepdive_search_results
   "[search_query_deepdive]"
   
   #claude: deepdive_analysis_ai
   "Generate a 'Deep-Dive Analysis' for the user's selected focus area.
   
   User Profile:
   [company_profile]
   
   Selected Focus Area:
   [focus_area]
   
   Search Results:
   [deepdive_search_results]
   
   Please generate the following:
   1.  **Specific Actions:** Short-, mid-, and long-term steps.
   2.  **Estimated Budget Range:** A high-level estimate (e.g., Low, Medium, High).
   3.  **Key KPIs & Milestones:** How to measure success.
   4.  **Recommended Partners or Enablers:** Specific local entities (like MISA, Monsha'at, KAUST, RSG, etc.) that can help."
   
   #Text: deepdive_analysis
   "[deepdive_analysis_ai]"
   #Show: "### Step 7: Deep-Dive Analysis
   [deepdive_analysis]"
   
#End
## --- End of Advanced Mode Logic ---

## --- Step 8: Market Entry Summary Report ---
#Show: "Compiling your final report..."

## Use Gemini for the final compilation as it supports longer outputs.
#gemini: final_report_ai
"You are a world-class market entry consultant. Compile a professional 'Market Entry Strategy Report' for the user.
Use all the information provided below.
If a section is 'N/A (Standard Mode)', state that this was a high-level report and that section can be explored in an 'Advanced' run.

## 1. Company Background
[company_profile]

## 2. Market Opportunity Overview
[market_overview]

## 3. Recommended Entry Model
[entry_modes]

## 4. Challenges & Mitigation Plan
[risk_analysis]

## 5. 6-12 Month Roadmap (Deep-Dive Focus)
[deepdive_analysis]

Compile this into a single, clean, professional report with clear markdown headings. Start with '# Market Entry Strategy Report'."

#Text: final_report
"[final_report_ai]"
#Show: "[final_report]"

## --- Step 9: Feedback Loop ---
## Allow the user to refine the final report.
#Question: feedback
"Do you have any feedback on this text?
(e.g., 'expand on the challenges', 'make the roadmap more detailed', or 'n' to stop)"
#Loop-Until: [feedback]="n"
   #Show: "Working on your revisions..."
   #gemini: final_report_ai
   "[feedback]"
   #Text: final_report
   "[final_report_ai]"
   #Show: "[final_report]"
   #Question: feedback
   "Any other feedback?
   ('n' = stop)"
#End

#Show: "Thank you for using the New Market Entry Strategist!"
